All functions was created by Kasia Palichleb
The last function was written by me